@page
@model IndexModel
@{
	ViewData["Title"] = "Log-in";
}

@if (HttpContext.Request.Cookies["UserID"] != "0" && HttpContext.Request.Cookies["UserStatus"] == "true")
{
	<div class="text-center">
		<h1 class="display-1">Admin</h1>
	</div>

	<div class="text-center">
		<h3 class="display-3">Institutions</h3>

		<form method="post" asp-page-handler="CreateInstitute">
			<input type="text" asp-for="InstituteRegion" placeholder="Region" class="form-label" required />
			<input type="text" asp-for="InstituteCity" placeholder="By" class="form-label" required />
			<input type="number" asp-for="InstitutePostal" placeholder="Postnummer" class="form-label" required />
			<input type="text" asp-for="InstituteRoadName" placeholder="Vejnavn" class="form-label" required />
			<input type="text" asp-for="InstituteRoadNumber" placeholder="Vejnummer" class="form-label" required />
			<input type="submit" value="Create Institute" />
		</form>
	</div>
	<div>
		<form method="post" asp-page-handler="LogOut">
			<input type="submit" value="LogOut" />
		</form>
	</div>
}
else if (HttpContext.Request.Cookies["UserID"] != "0" && HttpContext.Request.Cookies["UserStatus"] == "false")
{
	<div class="text-center">
		<h1 class="display-1">Teacher</h1>
	</div>
	<div>
		<form method="post" asp-page-handler="LogOut">
			<input type="submit" value="LogOut" />
		</form>
	</div>
}
else
{
	<div class="text-center">
		<h1 class="display-1">LoMaS</h1>
		<form method="post" asp-page-handler="LogIn">
			<div class="mb-3 mt-3">
				<h3 class="display-6">Email</h3>
				<input type="email" asp-for="Email" class="form-label" required />
			</div>
			<div class="mb-3 mt-3">
				<h3 class="display-6">Password</h3>
				<input type="password" asp-for="Pass" class="form-label" required />
			</div>
			<input type="submit" value="Log-in" />
			<h1></h1>
			@if (Model.FailedToLogIn == true)
			{
				<div class="alert alert-danger" role="alert">
					Email or Password incorrect
				</div>
			}
			@if (Model.FailedToLogIn == false)
			{
				HttpContext.Response.Cookies.Append("UserID", Model.CookieID);
				HttpContext.Response.Cookies.Append("UserStatus", Model.CookieIsAdmin);
			}
			@if(Model.NeedToRefresh == true)
			{
				<script>window.location.reload()</script>;
			}
		</form>
	</div>
}
